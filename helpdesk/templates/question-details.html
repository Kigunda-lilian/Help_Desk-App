{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block content %}
    <p>Posted by: {{ post.post_owner.username }} </p>
    <h1> {{ post.question }}? </h1>
    <!--Approve ans -->
    {% if post.post_owner %}
    <a href=" {% url 'approve_ans' post.id %} "> Approve Answers</a>
    {% endif %}
    
    
    <h2>{{ comments.count }} Answer{{comments|pluralize}}</h2>
    <!--likes and dislikes-->
    <div class="d-flex flex-row">
        <form method="POST" action="{% url 'like' post.id %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button style="background-color: transparent; border: none; box-shadow: none;" type="submit">
                <i class="far fa-thumbs-up"> <span>{{ post.likes.all.count }}</span></i>
            </button>
        </form>

        <form method="POST" action="{% url 'dislike' post.id %}">
            {% csrf_token %}
            <input type="hidden" name="next" value="{{ request.path }}">
            <button style="background-color: transparent; border: none; box-shadow: none;" type="submit">
                <i class="far fa-thumbs-down"> <span>{{ post.dislikes.all.count }}</span></i>
            </button>
        </form>
</div>
<div>
    <form method="post">
        {% csrf_token %}
        {{ comment_form.as_p}}
        {% if request.user.is_authenticated %}
            <input type="submit" value="Submit" class="btn btn-outline-success">
        {% else %}
            <input type="submit" value="Submit" class="btn btn-outline-success" disabled>
        {% endif %}
    </form>
</div>


    {% for comment in comments %}
        <figure>
            <blockquote class="blockquote">
            {% if comment.agreed %}
                <i style="color: green;" class="fa-solid fa-circle-check"> <span>This Answer Worked!!</span></i>
            {% else %}
            
            {% if comment.post.post_owner %}
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value=" {{comment.id }}" name="boxes">
                </div>
            <br>
            {% endif %}
            <div class="card">
                <div class="row">
                    <div class="col-md-9">
                        <p class="card-header">
                            {{ comment.body }}
                        </p>
                    </div>
                    <div class="col-md-3">
                        <p class="card-header">
                            <small>
                                Answered By:
                            {{ comment.user }}
                            </small>
                        </p>
                    </div>
                </div>
              </div>
            {% endif %}
            </blockquote>

<!--comment likes and dislikes-->
    <div class="d-flex flex-row">
        <a href=" {% url 'likecomment' comment.id post.id %} ">
            <button style="background-color: transparent; border: none; box-shadow: none;" type="submit">
                <i class="far fa-thumbs-up"> <span>{{ comment.total_likes }}</span></i>
            </button>
        </a>
        <a href=" {% url 'dislikecomment' comment.id post.id %} ">
            <button style="background-color: transparent; border: none; box-shadow: none;" type="submit">
                <i class="far fa-thumbs-down"> <span>{{ comment.total_dislikes }}</span></i>
            </button>
        </a>
        <figcaption class="blockquote-footer">by<cite title="Source Title">{{comment.user|capfirst}}</cite>
        </figcaption>
        </figure>
    {% endfor %}
{% endblock %}
